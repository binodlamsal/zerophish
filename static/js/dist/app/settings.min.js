$(document).ready(function(){function e(e,t){if(e.files&&e.files[0]){if(1.4*e.files[0].size>5e6)return void alert("The "+t+" image file is too large (must not exceed ~5MB)");var a=new FileReader;a.onload=function(e){$("#"+t+"-preview").attr("src",e.target.result),$("#"+t).val(e.target.result)},a.readAsDataURL(e.files[0])}}$("#time_zone.form-control").select2({placeholder:"Select Timezone",data:moment.tz.names()}),$("#apiResetForm").submit(function(e){return api.reset().success(function(e){user.api_key=e.data,successFlash(e.message),$("#api_key").val(user.api_key)}).error(function(e){errorFlash(e.message)}),!1}),$("#settingsForm").submit(function(e){return e.preventDefault(),$.post("/settings",$(this).serialize()).done(function(e){successFlash(e.message)}).fail(function(e){errorFlash(e.responseJSON.message)}),!1});var t=localStorage.getItem("gophish.use_map");$("#use_map").prop("checked",JSON.parse(t)),$("#use_map").on("change",function(){localStorage.setItem("gophish.use_map",JSON.stringify(this.checked))}),$(document).on("change",".btn-file .logo :file",function(){var e=$(this),t=e.val().replace(/\\/g,"/").replace(/.*\//,"");e.trigger("fileselect",[t])}),$(document).on("change",".btn-file .avatar :file",function(){var e=$(this),t=e.val().replace(/\\/g,"/").replace(/.*\//,"");e.trigger("fileselect",[t])}),$(".btn-file .logo :file").on("fileselect",function(e,t){var a=$(this).parents(".input-group").find(":text"),i=t;a.length?a.val(i):i&&alert(i)}),$(".btn-file .avatar :file").on("fileselect",function(e,t){var a=$(this).parents(".input-group").find(":text"),i=t;a.length?a.val(i):i&&alert(i)}),$("#logo-input").change(function(){e(this,"logo")}),$("#avatar-input").change(function(){e(this,"avatar")}),$("button#reset-logo").click(function(e){e.preventDefault(),$("#logo-preview").attr("src","data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),$("#logo").val("DELETE")}),$("button#reset-avatar").click(function(e){e.preventDefault(),$("#avatar-preview").attr("src","data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),$("#avatar").val("DELETE")})});